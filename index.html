<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÆ Numerus</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-image: url('');
            background-size: cover;
            color: white;
            text-align: center;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        input, select, button {
            padding: 10px;
            margin: 5px;
            width: 100%;
        }
        .result {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* M·∫∑c ƒë·ªãnh PC: 3 c·ªôt */
            gap: 10px;
            margin-top: 20px;
            padding: 10px;
            background: transparent;
            border-radius: 10px;
        }

        .result-item {
            padding: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        }

        /* Mobile: 4-5 c·ªôt khi m√†n h√¨nh nh·ªè */
        @media (max-width: 768px) {
            .result {
                grid-template-columns: repeat(4, 1fr); /* 4 c·ªôt cho mobile */
            }
        }

        /* ƒêi·ªán tho·∫°i nh·ªè h∆°n: 2-3 c·ªôt */
        @media (max-width: 480px) {
            .result {
                grid-template-columns: repeat(4, 1fr); /* 2 c·ªôt cho ƒëi·ªán tho·∫°i nh·ªè */
            }
        }

        .current-date-container {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
        }
        .current-date-container select {
            flex: 1;
            min-width: 100px;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
        }
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: pointer;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 250px;
            background-color: rgba(0, 0, 0, 0.8);
            color: #fff;
            text-align: center;
            padding: 10px;
            border-radius: 10px;
            position: absolute;
            z-index: 100;
            bottom: 120%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        /* N√∫t h·ªèi ƒë√°p */
        #chat-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #c064e1;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }

        #chat-button:hover {
            background-color: #efefef;
        }

        /* Khung chat */
        #chat-box {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 300px;
            height: 400px;
            background-color: rgb(205, 96, 241);
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: none;
            flex-direction: column;
            z-index: 1000;
        }

        #chat-header {
            background-color: #cd72e6;
            color: white;
            padding: 10px;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #close-chat {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            position: absolute;
        }

        #chat-body {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            background-color: #f9f9f9;
        }

        #chat-messages {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .message {
            padding: 8px 12px;
            border-radius: 10px;
            max-width: 80%;
        }

        .message.user {
            background-color: #c47bf8;
            color: white;
            align-self: flex-end;
        }

        .message.bot {
            background-color: #e1e1e1;
            color: black;
            align-self: flex-start;
        }

        #chat-input-container {
            display: flex;
            padding: 10px;
            background-color: #fff;
            border-top: 1px solid #ddd;
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
        }

        #chat-input {
            flex: 1;
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 5px;
            outline: none;
        }

        #send-button {
            margin-left: 10px;
            padding: 8px 12px;
            font-size: 14px;
            background-color: #b37aef;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 60px;
        }

        #send-button:hover {
            background-color: #f7f7f7;
        }
        /* N√∫t Messenger */
        #messenger-button {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background-color: #ffffff;
            color: white;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
        }

        #messenger-button:hover {
            background-color: #ad65e5;
        }
        /* N√∫t zalo */
        #zalo-button {
            position: fixed;
            bottom: 140px;
            right: 20px;
            background-color: #ffffff;
            color: white;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
        }

        #zalo-button:hover {
            background-color: #ad65e5;
        }

    </style>
</head>
<body>
    <div class="container">
        <h1>Numerology Calculator</h1>
        <input type="text" id="name" placeholder="Nh·∫≠p h·ªç t√™n">
        <h2 style="font-size: 10px;">Nh·∫≠p ng√†y/th√°ng/nƒÉm sinh</h2>
        <div class="current-date-container">
            <input list="birthDayList" id="birthDay" placeholder="Ng√†y">
            <input list="birthMonthList" id="birthMonth" placeholder="Th√°ng">
            <input list="birthYearList" id="birthYear" placeholder="NƒÉm">
        
            <datalist id="birthDayList"></datalist>
            <datalist id="birthMonthList"></datalist>
            <datalist id="birthYearList"></datalist>
        </div>
        <!-- N√∫t zalo -->
        <a id="zalo-button" href="https://zalo.me/0778305689" target="_blank">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/Icon_of_Zalo.svg/1200px-Icon_of_Zalo.svg.png" alt="zalo" style="width: 24px; height: 24px;">
        </a>
        <!-- N√∫t Messenger -->
        <a id="messenger-button" href="https://www.facebook.com/ThinhnguyenEDA" target="_blank">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/be/Facebook_Messenger_logo_2020.svg/1024px-Facebook_Messenger_logo_2020.svg.png" alt="Messenger" style="width: 24px; height: 24px;">
        </a>
        <!-- N√∫t h·ªèi ƒë√°p -->
        <div id="chat-button" onclick="toggleChat()">üí¨ H·ªèi ƒë√°p</div>

        <!-- Khung chat -->
        <div id="chat-box">
            <div id="chat-header">
                <span>H·ªèi ƒë√°p v·ªÅ Th·∫ßn s·ªë h·ªçc</span>
                <button id="close-chat" onclick="toggleChat()">√ó</button>
            </div>
            <div id="chat-body">
                <div id="chat-messages"></div>
            </div>
            <div id="chat-input-container">
                <input type="text" id="chat-input" placeholder="Nh·∫≠p c√¢u h·ªèi c·ªßa b·∫°n..." onkeypress="handleChatInput(event)">
                <button id="send-button" onclick="sendMessage()">G·ª≠i</button>
            </div>
        </div>
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const currentYear = new Date().getFullYear();
                const data = {
                    birthDayList: [1, 31],
                    birthMonthList: [1, 12],
                    birthYearList: [1900, currentYear]
                };
        
                Object.entries(data).forEach(([id, range]) => {
                    document.getElementById(id).innerHTML = Array.from(
                        { length: range[1] - range[0] + 1 },
                        (_, i) => `<option value="${i + range[0]}"></option>`
                    ).join('');
                });
            });
        </script>
        
        <style>
            .current-date-container {
                display: flex;
                gap: 10px;
                justify-content: center;
                align-items: center;
                margin-top: 10px;
            }
        
            .current-date-container input {
                flex: 1;
                min-width: 100px;
                padding: 10px;
                border-radius: 10px;
                text-align: center;
            }
        </style>
        <h3 style="font-size: 10px;">Nh·∫≠p ng√†y/th√°ng/nƒÉm hi·ªán t·∫°i</h3>
        <div class="current-date-container">
            <select id="currentYear"></select>
            <select id="currentMonth"></select>
            <select id="currentDay"></select>
        </div>
        <button onclick="calculateNumerology()">T√≠nh to√°n</button>
        <div class="result" id="result"></div>
    </div>

    <script>
        let numerologyResults = null; // Bi·∫øn to√†n c·ª•c ƒë·ªÉ l∆∞u k·∫øt qu·∫£
        // API Key c·ªßa Cohere (thay th·∫ø b·∫±ng API Key c·ªßa b·∫°n)
        const COHERE_API_KEY = "9MHD0XvvmkJQGfQpogAmNw6ozsZalaZa57OVFMPE"; // Thay YOUR_COHERE_API_KEY b·∫±ng API Key th·ª±c t·∫ø

        // Hi·ªÉn th·ªã/·∫©n khung chat
        function toggleChat() {
            const chatBox = document.getElementById('chat-box');
            chatBox.style.display = chatBox.style.display === 'flex' ? 'none' : 'flex';
        }

        // X·ª≠ l√Ω nh·∫≠p li·ªáu t·ª´ ng∆∞·ªùi d√πng
        function handleChatInput(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // G·ª≠i tin nh·∫Øn
        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (message === '') return;

            // Hi·ªÉn th·ªã tin nh·∫Øn c·ªßa ng∆∞·ªùi d√πng
            displayMessage(message, 'user');

            // G·ªçi API Cohere ƒë·ªÉ nh·∫≠n ph·∫£n h·ªìi
            const response = await getCohereResponse(message);
            displayMessage(response, 'bot');

            // X√≥a n·ªôi dung input
            input.value = '';
        }

        // Hi·ªÉn th·ªã tin nh·∫Øn
        function displayMessage(message, sender) {
            const chatMessages = document.getElementById('chat-messages');
            const messageElement = document.createElement('div');
            messageElement.classList.add('message', sender);
            messageElement.textContent = message;
            chatMessages.appendChild(messageElement);

            // Cu·ªôn xu·ªëng d∆∞·ªõi c√πng
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // G·ªçi API Cohere ƒë·ªÉ nh·∫≠n ph·∫£n h·ªìi
        async function getCohereResponse(message) {
            if (!numerologyResults) {
                return "Vui l√≤ng t√≠nh to√°n c√°c ch·ªâ s·ªë tr∆∞·ªõc khi h·ªèi.";
            }

            // Th√™m h∆∞·ªõng d·∫´n r√µ r√†ng ƒë·ªÉ AI tr·∫£ l·ªùi b·∫±ng ti·∫øng Vi·ªát
            const context = `B·∫°n l√† m·ªôt chuy√™n gia Numerology. H√£y tr·∫£ l·ªùi c√¢u h·ªèi sau b·∫±ng ti·∫øng Vi·ªát m·ªôt c√°ch ng·∫Øn g·ªçn v√† d·ªÖ hi·ªÉu. C√°c ch·ªâ s·ªë Numerology c·ªßa b·∫°n l√†: 
            - ƒê∆∞·ªùng ƒë·ªùi: ${numerologyResults.birthValue}
            - C√¢n b·∫±ng: ${numerologyResults.balanceValue}
            - S·ª© m·ªánh: ${numerologyResults.finalSum}
            - Linh h·ªìn: ${numerologyResults.soulValue}
            - Nh√¢n c√°ch: ${numerologyResults.personalityValue}
            - NƒÉm c√° nh√¢n: ${numerologyResults.personalYear}
            C√¢u h·ªèi: ${message}`;

            const url = "https://api.cohere.com/v1/chat";
            const data = {
                model: "command-r-plus",
                message: context,
                temperature: 0.7,
                max_tokens: 500,
            };

            try {
                const response = await fetch(url, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer ${COHERE_API_KEY}`,
                    },
                    body: JSON.stringify(data),
                });

                const result = await response.json();
                console.log(result);
                return result.text;
            } catch (error) {
                console.error("L·ªói khi g·ªçi API Cohere:", error);
                return "Xin l·ªói, t√¥i kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn AI ngay l√∫c n√†y.";
            }
        }
        function removeDiacritics(str) {
            return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
        }

        function populateDateFields() {
            const yearSelect = document.getElementById('currentYear');
            const monthSelect = document.getElementById('currentMonth');
            const daySelect = document.getElementById('currentDay');
            const currentYear = new Date().getFullYear();

            for (let y = 2000; y <= currentYear + 10; y++) {
                yearSelect.innerHTML += `<option value="${y}">${y}</option>`;
            }

            for (let m = 1; m <= 12; m++) {
                monthSelect.innerHTML += `<option value="${m}">${m}</option>`;
            }

            for (let d = 1; d <= 31; d++) {
                daySelect.innerHTML += `<option value="${d}">${d}</option>`;
            }

            yearSelect.value = currentYear;
            monthSelect.value = new Date().getMonth() + 1;
            daySelect.value = new Date().getDate();
        }
        function calculateMissingNumbers(name) {
            const counts = Array(9).fill(0);
            name.toLowerCase().split('').forEach(char => {
                const num = letterValues[char] || 0;
                if (num > 0) counts[num - 1]++;  // ƒê·∫øm s·ªë l·∫ßn xu·∫•t hi·ªán
            });

            // T√¨m c√°c s·ªë t·ª´ 1 ƒë·∫øn 9 m√† kh√¥ng xu·∫•t hi·ªán
            const missing = counts.map((count, index) => (count === 0 ? index + 1 : null)).filter(n => n !== null);
            return missing;
        }


        function populateBirthDateFields() {
            const birthYearSelect = document.getElementById('birthYear');
            const birthMonthSelect = document.getElementById('birthMonth');
            const birthDaySelect = document.getElementById('birthDay');
            const currentYear = new Date().getFullYear();

            for (let y = 1900; y <= currentYear; y++) {
                birthYearSelect.innerHTML += `<option value="${y}">${y}</option>`;
            }

            for (let m = 1; m <= 12; m++) {
                birthMonthSelect.innerHTML += `<option value="${m}">${m}</option>`;
            }

            updateDays(birthMonthSelect.value, birthYearSelect.value);

            birthMonthSelect.addEventListener('change', () => updateDays(birthMonthSelect.value, birthYearSelect.value));
            birthYearSelect.addEventListener('change', () => updateDays(birthMonthSelect.value, birthYearSelect.value));

            birthYearSelect.value = currentYear - 20;
            birthMonthSelect.value = 1;
            birthDaySelect.value = 1;
        }

        function updateDays(month, year) {
            const birthDaySelect = document.getElementById('birthDay');
            birthDaySelect.innerHTML = '';
            const daysInMonth = new Date(year, month, 0).getDate();
            for (let d = 1; d <= daysInMonth; d++) {
                birthDaySelect.innerHTML += `<option value="${d}">${d}</option>`;
            }
        }

        function reduceNumber(n) {
            while (n >= 10 && ![11, 22, 33].includes(n)) {
                n = n.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);
            }
            return n;
        }

        function customReduceNumber(n) {
            if ([11, 22, 33].includes(n)) return n;
            while (n >= 10) {
                n = n.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);
                if ([11, 22, 33].includes(n)) return n;
            }
            return n;
        }


        function changReduceNumber(n) {
            while (n >= 10) {
                n = n.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);
            }
            return n;
        }

        const letterValues = {
            'a': 1, 'b': 2, 'c': 3, 'd': 4, 'e': 5, 'f': 6, 'g': 7, 'h': 8, 'i': 9,
            'j': 1, 'k': 2, 'l': 3, 'm': 4, 'n': 5, 'o': 6, 'p': 7, 'q': 8, 'r': 9,
            's': 1, 't': 2, 'u': 3, 'v': 4, 'w': 5, 'x': 6, 'y': 7, 'z': 8
        };
        function findMostFrequentNumber(name) {
            const counts = {};
            const numbers = name.toLowerCase().split('').map(char => letterValues[char] || 0);

            for (const num of numbers) {
                if (num > 0) {
                    counts[num] = (counts[num] || 0) + 1;
                }
            }

            let maxCount = 0;
            let mostFrequent = null;
            for (const [num, count] of Object.entries(counts)) {
                if (count > maxCount) {
                    maxCount = count;
                    mostFrequent = parseInt(num);
                }
            }

            return mostFrequent;
        }

        function calculateNameValue(name) {
            const nameParts = name.toLowerCase().normalize("NFD").replace(/[ÃÄ-ÕØ]/g, "").split(" ");
            const vowels = "aeiou";

            let soulValue = 0;
            let personalityValue = 0;
            let totalSoulSum = 0;
            let soulDetails = [];  // üî• L∆∞u c√°c nguy√™n √¢m + s·ªë t∆∞∆°ng ·ª©ng
            let balanceDetails = []; // üî• L∆∞u ch·ªØ c√°i ƒë·∫ßu + s·ªë t∆∞∆°ng ·ª©ng
            const reducedSums = [];
            const firstLetterValues = [];
            let nameValue = 0;

            for (const char of name) {
                nameValue += letterValues[char] || 0;
            }
            let personalityDetails = [];

            for (const part of nameParts) {
                for (const char of part) {
                    if (!vowels.includes(char)) {
                        const value = letterValues[char] || 0;
                        personalityDetails.push(`${char}:${value}`);
                    }
                }
            }
            for (const part of nameParts) {
                let totalSum = 0;
                let soulSum = 0;

                for (const char of part) {
                    const value = letterValues[char] || 0;
                    totalSum += value;
                    if (vowels.includes(char)) {
                        soulSum += value;
                        soulDetails.push(`${char}:${value}`);  // üî• L∆∞u chi ti·∫øt nguy√™n √¢m
                    } else {
                        personalityValue += value;
                    }
                }

                totalSoulSum += soulSum;
                reducedSums.push(reduceNumber(totalSum));
                soulValue += reduceNumber(soulSum);

                if (part.length > 0) {
                    let firstChar = part[0];  // üî• L·∫•y ch·ªØ c√°i ƒë·∫ßu ti√™n
                    let firstCharValue = letterValues[firstChar] || 0;
                    firstLetterValues.push(firstCharValue);
                    balanceDetails.push(`${firstChar}:${firstCharValue}`);  // üî• L∆∞u chi ti·∫øt ch·ªØ c√°i ƒë·∫ßu
                }
            }

            const balanceSum = firstLetterValues.reduce((a, b) => a + b, 0);
            const balanceValue = changReduceNumber(balanceSum);
            const finalSum = reduceNumber(reducedSums.reduce((a, b) => a + b, 0));
            const lastNameValue = nameParts.length > 0 ? reduceNumber(nameParts[nameParts.length - 1].split('').reduce((sum, char) => sum + (letterValues[char] || 0), 0)) : 0;

            return {
                reducedSums,
                finalSum,
                soulSum: totalSoulSum,
                soulValue, 
                soulDetails,  // üî• Tr·∫£ v·ªÅ danh s√°ch nguy√™n √¢m
                balanceSum,
                balanceValue, 
                balanceDetails,  // üî• Tr·∫£ v·ªÅ danh s√°ch ch·ªØ c√°i ƒë·∫ßu
                personalityValue: reduceNumber(personalityValue),
                personalityDetails,
                lastNameValue,
                nameValue
            };
        }





        function calculateChallenges(day, month, year) {
            const challenge1 = changReduceNumber(Math.abs(reduceNumber(day) - changReduceNumber(month)));
            const challenge2 = changReduceNumber(Math.abs(reduceNumber(day) - changReduceNumber(year)));
            const challenge3 = changReduceNumber(Math.abs(challenge1 - challenge2));
            const challenge4 = changReduceNumber(Math.abs(changReduceNumber(month) - changReduceNumber(year)));
            return { challenge1, challenge2, challenge3, challenge4 };
        }

        function calculateChang(day, month, year) {
            const chang1 = changReduceNumber(day + month);
            const chang2 = changReduceNumber(day + year);
            const chang3 = changReduceNumber(chang1 + chang2);
            const chang4 = changReduceNumber(month + year);
            return { chang1, chang2, chang3, chang4 };
        }
        function charToNumber(char) {
            if (!/[a-zA-Z]/.test(char)) return 0;  // Ch·ªâ x·ª≠ l√Ω k√Ω t·ª± ch·ªØ
            const alphabet = 'abcdefghijklmnopqrstuvwxyz';
            const index = alphabet.indexOf(char.toLowerCase());
            return index !== -1 ? (index % 9) + 1 : 0;
        }
        function calculateBirthValue(day, month, year) {
            const sum = reduceNumber(day) + reduceNumber(month) + reduceNumber(year);
            if ([11, 22, 33].includes(sum)) {
                return sum;  // Gi·ªØ s·ªë ƒë·∫∑c bi·ªát n·∫øu c√≥
            }
            return reduceNumber(sum);  // Gi·∫£m v·ªÅ 1 ch·ªØ s·ªë n·∫øu kh√¥ng ph·∫£i s·ªë ƒë·∫∑c bi·ªát
        }
        function splitDigits(num) {
            return num.toString().split("").join(" + ");
        }


        function calculateNumerology() {
            const name = removeDiacritics(document.getElementById('name').value);
            const day = parseInt(document.getElementById('birthDay').value);
            const month = parseInt(document.getElementById('birthMonth').value);
            const year = parseInt(document.getElementById('birthYear').value);
            const currentYear = parseInt(document.getElementById('currentYear').value);
            const currentMonth = parseInt(document.getElementById('currentMonth').value);
            const currentDay = parseInt(document.getElementById('currentDay').value);
            

            const { reducedSums, finalSum, soulValue, soulSum, soulDetails, personalityValue, personalityDetails, balanceValue, balanceSum, balanceDetails, lastNameValue, nameValue } = calculateNameValue(name);



            const dayValue = reduceNumber(day);
            const birthValue = calculateBirthValue(day, month, year);

            const maturityValue = reduceNumber(birthValue + finalSum);

            const linkValue = birthValue > finalSum 
                ? reduceNumber(Math.abs(changReduceNumber(birthValue) - finalSum)) 
                : reduceNumber(Math.abs(finalSum - changReduceNumber(birthValue)));

            const personalYear = reduceNumber(dayValue + month + currentYear);
            const personalMonth = reduceNumber(personalYear + currentMonth);
            const personalDay = reduceNumber(personalMonth + currentDay);

            const { challenge1, challenge2, challenge3, challenge4 } = calculateChallenges(day, month, year);
            const { chang1, chang2, chang3, chang4 } = calculateChang(day, month, year);

            const missingNumbers = Array.from({ length: 9 }, (_, i) => i + 1).filter(num => !name.toLowerCase().split('').map(char => letterValues[char] || 0).includes(num));
            const passion = findMostFrequentNumber(name);
            const logicalMind = changReduceNumber(lastNameValue + dayValue);
            const age1 = 36 - changReduceNumber(birthValue);
            const age2 = age1 + 9;
            const age3 = age2 + 9;
            const age4 = age3 + 9;
            const cyear1 = year + age1;
            const cyear2 = cyear1 + 9;
            const cyear3 = cyear2 + 9;
            const cyear4 = cyear3 + 9;
            // L∆∞u k·∫øt qu·∫£ v√†o bi·∫øn to√†n c·ª•c
            numerologyResults = {
                birthValue,
                balanceValue,
                finalSum,
                linkValue,
                soulValue,
                maturityValue,
                personalityValue,
                logicalMind,
                missingNumbers,
                passion,
                personalYear,
                personalMonth,
                personalDay,
                chang1,
                chang2,
                chang3,
                chang4,
                challenge1,
                challenge2,
                challenge3,
                challenge4,
            };

            const results = [
                { 
                    label: 'ƒê∆∞·ªùng ƒë·ªùi', 
                    value: birthValue,
                    tooltip: `B·∫±ng t·ªïng ng√†y th√°ng nƒÉm sinh:(${day}+${month}+${year}) ‚Üí ${reduceNumber(day)}+${reduceNumber(month)}+${reduceNumber(year)} = ${birthValue}${[11, 22, 33].includes(birthValue) ? ' (S·ªë ƒë·∫∑c bi·ªát)' : ''}`
                },
                {
                    label: 'C√¢n b·∫±ng',
                    value: balanceValue,
                    tooltip: `B·∫±ng t·ªïng c√°c ch·ªØ c√°i ƒë·∫ßu c·ªßa H·ªç v√† t√™n:(${balanceDetails.join(" + ")}) = ${balanceSum} ‚Üí ${balanceValue}${[11, 22, 33].includes(balanceValue) ? ' (S·ªë ƒë·∫∑c bi·ªát)' : ''}`
                },
                {
                    label: 'S·ª© m·ªánh',
                    value: finalSum,
                    tooltip: `B·∫±ng t·ªïng h·ªç v√† t√™n: ${name} ‚Üí ${[...name].map(char => `${char}: ${charToNumber(char)}`).join(' + ')} ‚Üí T·ªïng = ${nameValue} ‚Üí ${reduceNumber(nameValue)}${[11, 22, 33].includes(finalSum) ? ' (S·ªë ƒë·∫∑c bi·ªát)' : ''}`
                },
                {
                    label: 'Li√™n k·∫øt', 
                    value: linkValue,
                    tooltip: birthValue > finalSum 
                        ? `B·∫±ng hi·ªáu ƒë∆∞·ªùng ƒë·ªùi v√† s·ª© m·ªánh:${changReduceNumber(birthValue)} - ${finalSum} ‚Üí ${linkValue}${[11, 22, 33].includes(linkValue) ? ' (S·ªë ƒë·∫∑c bi·ªát)' : ''}`
                        : `B·∫±ng hi·ªáu s·ª© m·ªánh v√† ƒë∆∞·ªùng ƒë·ªùi:${finalSum} - ${changReduceNumber(birthValue)} ‚Üí ${linkValue}${[11, 22, 33].includes(linkValue) ? ' (S·ªë ƒë·∫∑c bi·ªát)' : ''}`
                },
                {
                    label: 'Linh h·ªìn', 
                    value: reduceNumber(soulValue),
                    tooltip: `(${soulDetails.join(" + ")}) = ${soulSum} ‚Üí ${reduceNumber(soulValue)}${[11, 22, 33].includes(reduceNumber(soulValue)) ? ' (S·ªë ƒë·∫∑c bi·ªát)' : ''}`
                },
                {
                    label: 'Tr∆∞·ªüng th√†nh',
                    value: maturityValue,
                    tooltip: `B·∫±ng ƒë∆∞·ªùng ƒë·ªùi + s·ª© m·ªánh:(${birthValue} + ${finalSum}) = ${birthValue + finalSum} ‚Üí ${maturityValue}${[11, 22, 33].includes(maturityValue) ? ' (S·ªë ƒë·∫∑c bi·ªát)' : ''}`
                },
                {
                    label: 'Nh√¢n c√°ch',
                    value: personalityValue,
                    tooltip: `B·∫±ng t·ªïng c√°c ph·ª• √¢m ${personalityDetails.join(" + ")} = ${personalityValue}${[11, 22, 33].includes(personalityValue) ? ' (S·ªë ƒë·∫∑c bi·ªát)' : ''}`
                },
                {
                    label: 'T∆∞ duy l√Ω tr√≠',
                    value: logicalMind,
                    tooltip: `B·∫±ng t√™n + ng√†y sinh:(${lastNameValue} , ${dayValue}) = ${lastNameValue + dayValue} ‚Üí ${logicalMind}${[11, 22, 33].includes(logicalMind) ? ' (S·ªë ƒë·∫∑c bi·ªát)' : ''}`
                },
                {
                    label: 'S·ª©c m·∫°nh ti·ªÅm th·ª©c',
                    value: 9 - missingNumbers.length,
                    tooltip: `S·ª©c m·∫°nh ti·ªÅm th·ª©c b·∫±ng  9 - l∆∞·ª£ng s·ªë thi·∫øu: ${9} - ${missingNumbers.length} ‚Üí ${9 - missingNumbers.length}`
                },
                {
                    label: 'Ng√†y sinh',
                    value: dayValue,
                    tooltip: `ng√†y sinh: ${day} = ${splitDigits(day)} ‚Üí ${dayValue}`
                },
                {
                    label: 'ƒêam m√™',
                    value: passion,
                    tooltip: `S·ªë hi·ªÉn th·ªã nhi·ªÅu nh·∫•t trong h·ªç v√† t√™n: ${passion}`
                },
                {
                    label: 'NƒÉm c√° nh√¢n',
                    value: personalYear,
                    tooltip: `ng√†y sinh + th√°ng sinh + nƒÉm hi·ªán t·∫°i: ${dayValue} + ${month} +${currentYear} ‚Üí ${personalYear}`
                },
                {
                    label: 'Th√°ng c√° nh√¢n',
                    value: personalMonth,
                    tooltip: `B·∫±ng t·ªïng nƒÉm c√° nh√¢n v√† th√°ng hi·ªán t·∫°i: ${personalYear} + ${currentMonth} ‚Üí ${personalMonth}`
                },
                {
                    label: 'Ng√†y c√° nh√¢n',
                    value: personalDay,
                    tooltip: `B·∫±ng t·ªïng th√°ng c√° nh√¢n v√† ng√†y hi·ªán t·∫°i: ${personalMonth} + ${currentDay} ‚Üí ${personalDay}`
                },
                {
                    label: 'Ch·∫∑ng',
                    value: `${chang1}, ${chang2}, ${chang3}, ${chang4}`,
                    tooltip: `
                        <p><strong>Chi ti·∫øt t√≠nh to√°n:</strong></p>
                        <p>Ch·∫∑ng 1: (${day} + ${month} = ${chang1})</p>
                        <p>Ch·∫∑ng 2: (${day} + ${year} = ${chang2})</p>
                        <p>Ch·∫∑ng 3: (${chang1} + ${chang2} = ${chang3})</p>
                        <p>Ch·∫∑ng 4: (${month} + ${year} = ${chang4})</p>
                        
                        <table border="1" cellspacing="0" cellpadding="5">
                            <tr>
                                <th>Ch·∫∑ng</th>
                                <td>${chang1}</td>
                                <td>${chang2}</td>
                                <td>${chang3}</td>
                                <td>${chang4}</td>
                            </tr>
                            <tr>
                                <th>Th√°ch th·ª©c</th>
                                <td>${challenge1}</td>
                                <td>${challenge2}</td>
                                <td>${challenge3}</td>
                                <td>${challenge4}</td>
                            </tr>
                            <tr>
                                <th>Tu·ªïi</th>
                                <td>0 - ${age1}</td>
                                <td>${age1 + 1} - ${age2}</td>
                                <td>${age2 + 1} - ${age3}</td>
                                <td>${age3 + 1} - ${age4}</td>
                            </tr>
                            <tr>
                                <th>NƒÉm</th>
                                <td>${year} - ${cyear1}</td>
                                <td>${cyear1 + 1} - ${cyear2}</td>
                                <td>${cyear2 + 1} - ${cyear3}</td>
                                <td>${cyear3 + 1} - ${cyear4}</td>
                            </tr>
                        </table>
                    `
                },
                {
                    label: 'Th√°ch th·ª©c',
                    value: `${challenge1}, ${challenge2}, ${challenge3}, ${challenge4}`,
                    tooltip: `
                        <p><strong>Chi ti·∫øt t√≠nh to√°n:</strong></p>
                        <p>Th√°ch th·ª©c 1: (${day} - ${month} = ${challenge1})</p>
                        <p>Th√°ch th·ª©c 2: (${day} - ${year} = ${challenge2})</p>
                        <p>Th√°ch th·ª©c 3: (${challenge1} - ${challenge2} = ${challenge3})</p>
                        <p>Th√°ch th·ª©c 4: (${month} - ${year} = ${challenge4})</p>

                        <table border="1" cellspacing="0" cellpadding="5">
                            <tr>
                                <th>Ch·∫∑ng</th>
                                <td>${chang1}</td>
                                <td>${chang2}</td>
                                <td>${chang3}</td>
                                <td>${chang4}</td>
                            </tr>
                            <tr>
                                <th>Th√°ch th·ª©c</th>
                                <td>${challenge1}</td>
                                <td>${challenge2}</td>
                                <td>${challenge3}</td>
                                <td>${challenge4}</td>
                            </tr>
                            <tr>
                                <th>Tu·ªïi</th>
                                <td>0 - ${age1}</td>
                                <td>${age1 + 1} - ${age2}</td>
                                <td>${age2 + 1} - ${age3}</td>
                                <td>${age3 + 1} - ${age4}</td>
                            </tr>
                            <tr>
                                <th>NƒÉm</th>
                                <td>${year} - ${cyear1}</td>
                                <td>${cyear1 + 1} - ${cyear2}</td>
                                <td>${cyear2 + 1} - ${cyear3}</td>
                                <td>${cyear3 + 1} - ${cyear4}</td>
                            </tr>
                        </table>
                    `
                },
                {
                    label: 'S·ªë thi·∫øu',
                    value: missingNumbers.join(', '),
                    tooltip: `S·ªë kh√¥ng c√≥ trong h·ªç v√† t√™n: ${missingNumbers.join(', ')}`
                },
            ];

            document.getElementById('result').innerHTML = results
                .map(item => {
                    const tooltip = item.tooltip ? `<div class="tooltip-text">${item.tooltip}</div>` : '';
                    return `<div class="result-item tooltip">
                                <strong>${item.label}:</strong> ${item.value}
                                ${tooltip}
                            </div>`;
                })
                .join('');

        }

        window.onload = () => {
            populateDateFields();
            populateBirthDateFields();
        };
    </script>
</body>
</html>
